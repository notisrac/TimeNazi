<!DOCTYPE html>
<html>
  
  <head>
    <title>TimeNazi - eyesight police :)</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="stylesheet" href="stylesheet/site.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="scripts/markdown.min.js"></script>
    <script>
      $(document).ready(function(){
        // get the background images
        $.get('http://notisrac.github.io/TimeNazi/files.list', function(data) {    
          var lines = data.split("\n");

          $.each(lines, function(n, elem) {
            if(elem.length > 0){
              var parts = elem.split(', ');
              $('#fillme').append('<a href="' + parts[0] + '" alt="">' + parts[0] + '</a>&nbsp;(md5: ' + parts[1].trim() + ')<br />');
            }
          });
        });
        // the template
        var releasesTemplate = $('#releasesTemplate');
        releasesTemplate.remove();
        // the releases container
        var releases = $('#releases');
        // get the releases
        $.get('https://api.github.com/repos/notisrac/TimeNazi/releases', function(data) {
          for(i = 0; i < data.length; i++){
            var tmpTemplate = releasesTemplate;
            tmpTemplate.children('#releasetitle').text(data[i].name);
            // user link
            tmpTemplate.find('#userLink').attr('href', data[i].author.html_url).html(function(){
              return $(this).html().replace('%USERNAME%', data[i].author.login);
            });
            // user avatar
            tmpTemplate.find('#userAvatar').attr('src', data[i].author.avatar_url);
            // publish date        
            tmpTemplate.find('.post-date').html(function(){
              return $(this).html().replace('%PUBLISHDATE%', data[i].published_at);
            });
            // release notes
            tmpTemplate.find('#releaseNotes').html(function(){
              return $(this).html().replace('%RELEASENOTES%', markdown.toHTML(data[i].body));
            });
            // release file
            tmpTemplate.find('#releaseFile').attr('href', data[i].assets.browser_download_url).html(function(){
              return $(this).html().replace('%RELEASEFILENAME%', data[i].assets.name);
            });
            // downloads
            var downloadsContainer = tmpTemplate.find('#downloads');
            var downloadFileTemplate = downloadsContainer.find('#downloadFile');
            downloadFileTemplate.remove();
            for(j = 0; j < data[i].assets.length; j++){
              var tmpDLTemplate = downloadFileTemplate;
              // process
              tmpDLTemplate.find('a').attr('href', data[i].assets[j].browser_download_url);
              tmpDLTemplate.html(function(){
                return $(this).html().replace('%DOWNLOADFILENAME%', data[i].assets[j].name).replace('%DOWNLOADFILESIZE%', Math.round((data[i].assets[j].size / 1024 / 1024) * 100) / 100);
              });
              // append to container
              downloadsContainer.append(tmpDLTemplate);
            }
            //console.log(postDate.text());
            // append to the container
            releases.append(tmpTemplate);         
          }
        }); 
      });
    </script>
  </head>
  
  <body>
    <div class="container">
      <div class="masthead">
        <h1 class="masthead-title">
          <img src="images/clock_128.png" width="32" height="32" style="padding-right:5px;"/>TimeNazi
              &nbsp;&nbsp;&nbsp;<small><a href="#faq">FAQ</a></small>
              &nbsp;&nbsp;&nbsp;<small><a href="#releases">Releases</a></small>
              &nbsp;&nbsp;&nbsp;<small><a href="#backgroundimages">Background images</a></small>
        </h1>
      </div>

      <!--<h1><img src="images/clock_128.png" width="32" height="32" style="padding-right:5px;"/>TimeNazi</h1>-->
      <p>
        An app to enforce you to take a break from the computer every x minutes<br />
        <a href="https://github.com/notisrac/TimeNazi" target="_blank">GitHub page</a>
      </p>
      <br />
      <div style="post">
        <h2 id="faq" style="post-title">FAQ:</h2>
        <p>
          <strong>How do I revoke the application's right to acces my google drive?</strong><br />
          On this <a href="https://security.google.com/settings/security/permissions" target="_blank">page</a>, select TimeNazi, and click "Remove".
        </p>
        <p>
          <strong>Where does the application store the logs/activity/background images/config files on my machine?</strong><br />
          Base directory: <code>C:\Users\&lt;username&gt;\AppData\Local\Noti\</code><br />
          ActivityLogs: <code>&lt;basedir&gt;\TimeNazi\ActivityLogs</code><br />
          Backgrounds: <code>&lt;basedir&gt;\TimeNazi\Backgrounds</code><br />
          Logs: <code>&lt;basedir&gt;\TimeNazi\Logs</code><br />
          Config: <br />
          &nbsp;&nbsp;v1.0.0: <code>&lt;basedir&gt;\TimeNazi.exe.*\&lt;version&gt;\user.config</code><br />
          &nbsp;&nbsp;v1.0.1+: <code>&lt;basedir&gt;\user.config</code>
        </p>
        <p>
          <strong>How does the database work?</strong><br />
          The database is basically a spreadsheet in your google drive. It has two sheets (plus one, created by the lib):
          <ul>- <i>Config:</i> has only one row, and contains the configuration of the app</ul>
          <ul>- <i>ActivityLog:</i> every time something happens in the app, it gets inserted here</ul>
        </p>
        <p>
          <strong>How does the application know what background files to download and from where?</strong><br />
          The background images are hosted in this GitHub page in a <a href="http://notisrac.github.io/TimeNazi/files.list">files.list</a> file. It contains the names and the MD5 hash of the files.
          The application has a key by the name of <code>BackgroundImagesSource</code> in it's config file. This key contains the link to the files.list file.
          When you press the "Check" button on the settings window's "Background images" section, it downloads and parses the files.list file.
          For every entry in the file, it checks whether that file can be found on the local disk. If not, or if it has been modified (compares the MD5 hashes of both of the files), the file will be added to a list.
          When you press the "Download" button, it only downloads the files in the list.
          This means two things:
          <ol>1. Local files will not be deleted. So you can add your own files locally.</ol>   
          <ol>2. You always have to press the "Check" button prior to pressing the "Download" button. Also the app only downloads new and modified files.</ol>
        </p>
        <p>
          <strong>How can I exit the application while on the rest screen?</strong><br />
          Ctrl + Alt + Shift + F12
        </p>
      </div>

      <br />
      <div id="releases" style="post">
        <h2 style="post-title">Releases:</h2>
        <span id="releasesTemplate">
          <h3 id="releasetitle" style="post-title"></h3>
          <span class="post-date"><a id="userLink" href=""><img id="userAvatar" src="" width="20" height="20" />&nbsp;%USERNAME%</a>&nbsp;on&nbsp;%PUBLISHDATE%</span>
          <p id="releaseNotes">
            %RELEASENOTES%
          </p>
          <strong>Downloads:</strong>
          <span id="downloads">
            <ul id="downloadFile"><a href="">%DOWNLOADFILENAME%</a>&nbsp;(%DOWNLOADFILESIZE%&nbsp;MiB)</ul>
          </span>
        </span>
      </div>
  
      <br />
      <div style="post">
        <h2 id="backgroundimages" style="post-title">Background files:</h2>
        <span class="post-date">source: <a href="http://notisrac.github.io/TimeNazi/files.list">files.list</a></span>
        <div id="fillme"></div>
      </div>
      <div class="site-footer">&copy; 2015, noti</div>
    </div>
  </body>
</html>
